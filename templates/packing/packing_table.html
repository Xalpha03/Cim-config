<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />

<div class="card shadow-lg border-0 rounded-4 mt-5 overflow-hidden">
  <!-- En-tÃªte stylisÃ©e -->
  <div class="card-header text-white text-center fw-bold fs-5 py-3" style="background: linear-gradient(90deg, #212529 0%, #0d6efd 60%, #6610f2 100%); letter-spacing: 1px; text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.25);">
    âš™ï¸ Tableau des Pannes â€“ <span class="fw-light">Suivi quotidien</span>
  </div>

  <!-- Tableau principal -->
  <div class="card-body p-0 table-responsive">
    <table class="table table-hover table-bordered table-sm align-middle text-center mb-0">
      <!-- En-tÃªte du tableau -->
      <thead class="table-primary text-uppercase small">
        <tr>
          <th rowspan="2" class="fs-6 align-middle">#</th>

          {% if admin %}
            <th rowspan="2" class="fs-6 align-middle">ğŸ§‘â€ğŸ’¼ user</th>
          {% endif %}

          <th rowspan="2" class="fs-6 align-middle">ğŸ“ Poste</th>
          <th colspan="5" class="fs-6 align-middle">ğŸ­ Packing</th>
          <th colspan="2" class="fs-6 align-middle">â±ï¸ DurÃ©e</th>
        </tr>
        <tr class="table-light">
          <th class="fs-6">ğŸšš Livraison</th>
          <th class="fs-6">ğŸ’¥ Casse</th>
          <th class="fs-6">ğŸ“‰ Tx Casse</th>
          <th class="fs-6">ğŸª£ Vrack</th>
          <th class="fs-6">ğŸ“ˆ Rendement</th>
          <th class="fs-6">â›” ArrÃªt</th>
          <th class="fs-6">âœ… Marche</th>
        </tr>
      </thead>

      <!-- Corps du tableau -->
      <tbody>
        {% if object_pack %}
          {% for iteam in object_pack %}
            <tr class="align-middle {% if iteam.livraison|default:0 > 206 %}table-success{% elif iteam.livraison|default:0 > 200 %}table-warning{% else %}table-danger{% endif %}">
              <td class="fw-bold">{{ forloop.counter }}</td>

              {% if admin %}
                <td class="fw-bold text-primary">{{ iteam.user }}</td>
              {% endif %}

              <td class="fw-bold text-primary">{{ iteam.title }}</td>
              <td>{{ iteam.livraison }}</td>
              <td>{{ iteam.casse }}</td>
              <td>{{ iteam.tx_cas|floatformat:2 }} %</td>
              <td>{{ iteam.vrack }}</td>
              <td>{{ iteam.rend }}</td>
              <td>{{ iteam.temp_arret_formate }}</td>
              <td>{{ iteam.temp_march_formate }}</td>
            </tr>
          {% endfor %}
        {% else %}
          <tr>
            <td colspan="8" class="text-center text-muted py-4 fst-italic">ğŸŒŸ Aucune panne enregistrÃ©e pour cette date.</td>
          </tr>
        {% endif %}
      </tbody>

      <tfoot class="text-white fw-bold" style="background: linear-gradient(90deg, #198754, #20c997); letter-spacing: 0.5px;">
        <tr>
          {% if admin %}
            <td colspan="3" class="text-end pe-3 border-0 fs-6">ğŸ”¢ Total :</td>
          {% else %}
            <td colspan="2" class="text-end pe-3 border-0 fs-6">ğŸ”¢ Total :</td>
          {% endif %}

          <td class="text-center pe-3 border-0 fs-6">{{ total_liv }}</td>
          <td class="text-center pe-3 border-0 fs-6">{{ total_cas }}</td>
          <td class="text-center pe-3 border-0 fs-6">{{ moyenne_tx_cas }}</td>
          <td class="text-center pe-3 border-0 fs-6">{{ total_vrack }}</td>
          <td class="text-center pe-3 border-0 fs-6">{{ moyenne_rend }}</td>
          <td class="text-center pe-3 border-0 fs-6">{{ total_temp_arret }}</td>
          <td class="text-center pe-3 border-0 fs-6">{{ total_temp_march }}</td>
        </tr>
      </tfoot>
    </table>
  </div>
</div>

<!-- Styles additionnels -->
<style>
  /* Effet au survol des lignes */
  .table-hover tbody tr:hover {
    background-color: #f3f6fa !important;
    transform: scale(1.01);
    transition: all 0.25s ease-in-out;
  }
  
  /* Badges compacts et lisibles */
  .badge {
    font-size: 0.8rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.15);
  }
  
  /* Lignes plus confortables */
  table td,
  table th {
    vertical-align: middle !important;
    padding: 0.6rem !important;
  }
  
  /* Effet de survol subtil de la carte */
  .card {
    border-radius: 1rem;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  
  .card:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
  }
</style>
