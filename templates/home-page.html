{% extends 'base.html' %}
{% block title %}
  <title>Home Page</title>
{% endblock %}
{% block content %}
  <div class="container-fluid py-3">
    <div class="row">
      <div class="col-12 mb-4">
        <div class="card shadow-sm rounded-3">
          <div class="card-header bg-primary text-white text-center fs-3 fw-bold">
            {% if search_date %}
              Rapport du {{ search_date }}
            {% else %}
              Rapport
            {% endif %}
          </div>

          <div class="card-body p-0 table-responsive">
            <div class="row">
              <div class="col-8 bg-light m-0">
                <table class="table table-bordered border-black table-hover table-sm align-middle text-center mb-0">
                  <tbody class="">
                    <tr>
                      <th colspan="2" class="bg-light"></th>
                      <th class="text-dark bg-success-subtle">Post</th>
                      <th class="text-dark bg-orange-100">Conducteur</th>
                      <th colspan="2" class="bg-light"></th>
                    </tr>

                    {% comment %}Partie A{% endcomment %}
                    <tr>
                      <th class="text-dark fw-bolder bg-light">Packing Shift A Leader</th>

                      {% if object_post_06h %}
                        {% for object in object_pack %}
                          {% if object.post.post == '06H-14H' %}
                            <td class="text-dark bg-info-subtle fw-bolder">{{ object.user.get_full_name|default:'—' }}</td>
                          {% else %}
                            <td class="text-dark bg-info-subtle fw-bolder">—</td>
                          {% endif %}
                        {% endfor %}
                      {% else %}
                        <td class="text-dark bg-info-subtle fw-bolder">—</td>
                      {% endif %}

                      <td class="text-dark fw-bolder bg-light">A</td>

                      {% if object_broy_post_06h %}
                        {% for object in object_broy %}
                          {% if object.post.post == '06H-14H' %}
                            <td class="text-dark bg-info-subtle fw-bolder">{{ object.user.get_full_name|default:'—' }}</td>
                          {% else %}
                            <td class="text-dark bg-info-subtle fw-bolder">—</td>
                          {% endif %}
                        {% endfor %}
                      {% else %}
                        <td class="text-dark bg-info-subtle fw-bolder">—</td>
                      {% endif %}

                      <th class="text-dark fw-bolder bg-light">Grinding Shift A Leader</th>
                      {% if object_broy_post_06h %}
                        {% for object in object_broy %}
                          {% if object.post.post == '06H-14H' %}
                            <td class="text-dark bg-info-subtle fw-bolder">BATABA Tom</td>
                          {% else %}
                            <td class="text-dark bg-info-subtle fw-bolder">—</td>
                          {% endif %}
                        {% endfor %}
                      {% else %}
                        <td class="text-dark bg-info-subtle fw-bolder">—</td>
                      {% endif %}
                    </tr>

                    {% comment %}Partie B{% endcomment %}
                    <tr>
                      <th class="text-dark fw-bolder bg-light">Packing Shift B Leader</th>

                      {% if object_post_14h %}
                        {% for object in object_pack %}
                          {% if object.post.post == '14H-22H' %}
                            <td class="text-dark bg-info-subtle fw-bolder">{{ object.user.get_full_name|default:'—' }}</td>
                          {% else %}
                            <td class="text-dark bg-info-subtle fw-bolder">—</td>
                          {% endif %}
                        {% endfor %}
                      {% else %}
                        <td class="text-dark bg-info-subtle fw-bolder">—</td>
                      {% endif %}

                      <td class="text-dark fw-bolder bg-light">B</td>

                      {% if object_broy_post_14h %}
                        {% for object in object_broy %}
                          {% if object.post.post == '14H-22H' %}
                            <td class="text-dark bg-info-subtle fw-bolder">{{ object.user.get_full_name|default:'—' }}</td>
                          {% else %}
                            <td class="text-dark bg-info-subtle fw-bolder">—</td>
                          {% endif %}
                        {% endfor %}
                      {% else %}
                        <td class="text-dark bg-info-subtle fw-bolder">—</td>
                      {% endif %}

                      <th class="text-dark fw-bolder bg-light">Grinding Shift B Leader</th>
                      {% if object_broy_post_14h %}
                        {% for object in object_broy %}
                          {% if object.post.post == '14H-22H' %}
                            <td class="text-dark bg-info-subtle fw-bolder">BATABA Tom</td>
                          {% else %}
                            <td class="text-dark bg-info-subtle fw-bolder">—</td>
                          {% endif %}
                        {% endfor %}
                      {% else %}
                        <td class="text-dark bg-info-subtle fw-bolder">—</td>
                      {% endif %}
                    </tr>

                    {% comment %}Partie C{% endcomment %}
                    <tr>
                      <th class="text-dark fw-bolder bg-light">Packing Shift C Leader</th>

                      {% if object_post_22h %}
                        {% for object in object_pack %}
                          {% if object.post.post == '22H-06H' %}
                            <td class="text-dark bg-info-subtle fw-bolder">{{ object.user.get_full_name|default:'—' }}</td>
                          {% else %}
                            <td class="text-dark bg-info-subtle fw-bolder">—</td>
                          {% endif %}
                        {% endfor %}
                      {% else %}
                        <td class="text-dark bg-info-subtle fw-bolder">—</td>
                      {% endif %}

                      <td class="text-dark fw-bolder bg-light">C</td>

                      {% if object_broy_post_22h %}
                        {% for object in object_broy %}
                          {% if object.post.post == '22H-06H' %}
                            <td class="text-dark bg-info-subtle fw-bolder">{{ object.user.get_full_name|default:'—' }}</td>
                          {% else %}
                            <td class="text-dark bg-info-subtle fw-bolder">—</td>
                          {% endif %}
                        {% endfor %}
                      {% else %}
                        <td class="text-dark bg-info-subtle fw-bolder">—</td>
                      {% endif %}

                      <th class="text-dark fw-bolder bg-light">Grinding Shift C Leader</th>
                      {% if object_broy_post_22h %}
                        {% for object in object_broy %}
                          {% if object.post.post == '22H-06H' %}
                            <td class="text-dark bg-info-subtle fw-bolder">BATABA Tom</td>
                          {% else %}
                            <td class="text-dark bg-info-subtle fw-bolder">—</td>
                          {% endif %}
                        {% endfor %}
                      {% else %}
                        <td class="text-dark bg-info-subtle fw-bolder">—</td>
                      {% endif %}
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="col-4 bg-light">
                
              </div>
            </div>

            <div>
              {% include 'table.html' %}
              
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Deuxième bloc : arrêts -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="card shadow-sm rounded-3">
          <div class="card-body p-0 table-responsive">
            {% include 'home_pannes_table.html' %}
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Styles personnalisés -->
  <style>
    /* Couleurs adoucies */
    .bg-orange-100 {
      background-color: #fbc793 !important;
    }
    .bg-success-subtle {
      background-color: #b8f3bdff !important;
    }
    .bg-info-subtle {
      background-color: #c2d6f4ff !important;
    }
    .bg-warning-subtle {
      background-color: #fff6d6 !important;
    }
    .bg-violet {
      background-color: #c5b9f3ed !important;
      color: #fff !important;
    }
    
    /* Tailles et espacements */
    .heith {
      height: 160px !important;
    } /* réduit par rapport à l'original pour moins de poids visuel */
    .wdth {
      width: 30px !important;
    }
    table th,
    table td {
      vertical-align: middle !important;
      padding: 0.55rem !important;
      font-size: 0.95rem;
    }
    
    /* Sticky thead for better navigation when scrolling */
    thead th {
      position: sticky;
      top: 0;
      z-index: 5;
      backdrop-filter: blur(2px);
    }
    
    /* Card header visual */
    .card-header {
      border-bottom: 1px solid rgba(0, 0, 0, 0.08);
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .heith {
        height: auto !important;
      }
      table {
        font-size: 0.88rem;
      }
    }
  </style>

  {% include 'refreesh.html' %}
{% endblock %}
